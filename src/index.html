<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="styles.css"> 
        <title>Three.js Template</title>
        <style>
            body {
                margin: 0;
            }
            canvas {
                display: block;
            }
        </style>
    </head>
    <body>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dat-gui/0.7.7/dat.gui.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r126/three.min.js" integrity="sha512-n8IpKWzDnBOcBhRlHirMZOUvEq2bLRMuJGjuVqbzUJwtTsgwOgK5aS0c1JA647XWYfqvXve8k3PtZdzpipFjgg==" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/three@0.126.0/examples/js/loaders/GLTFLoader.js"></script>
    <script const gltfLoader = new THREE.GLTFLoader();></script>
        <script>
            let scene, camera, renderer, geometry, material, cube, textureLoader, edges, lines;
            // array 
            let cubes = [];
            const loader = new THREE.GLTFLoader();

        //datgui controller
        var gui = new dat.GUI();
            var gravityFolders = [];
        // camera follow mouse (away from center)
            window.addEventListener('mousemove', function(event) {
                camera.position.x = (event.clientX - window.innerWidth / 2) * 0.01;
                camera.position.y = (event.clientY - window.innerHeight / 2) * -0.01;
            });
            
        // loadobj function (no oop)
        //     function loadObj(){
        //     loader.load('./suzann.gltf', (gltf) => {
        //         console.log("GLTF model loaded successfully:", gltf);
        //         // Position and add the loaded model to the scene
        //         gltf.scene.position.set(0, 0, 0);
        //         gltf.scene.scale.set(1,1,1);
        //         scene.add(gltf.scene);
        //     })
        // }

        //load 3d OBJ
        class objectSpwn{
            constructor (initObj,setPosition,setScale){
                 this.initObj = initObj;
                 this.setPosition = setPosition;
                 this.setScale = setScale;
                 this.initObj.scene.position.set(this.setPosition.x, this.setPosition.y, this.setPosition.z);
                 this.initObj.scene.scale.set(this.setScale.x, this.setScale.y, this.setScale.z);
                scene.add(initObj.scene);
                }
            }
        
        function loadSuzann(){
            loader.load('./suzann.gltf', (gltf) => {
                console.log("GLTF model loaded successfully:", gltf);
                // Position and add the loaded model to the scene
                
                const setPosition = new THREE.Vector3 (0,0,0);
                const setScale = new THREE.Vector3 (1,1,1);
                let SuzannObj  = new objectSpwn (gltf, setPosition, setScale);
            })
        }
        function loadTeapot(){
            loader.load('./teaPot.glb',(gltf) => {
                console.log("teapot is loaded",gltf);
                const setPosition = new THREE.Vector3 (0,0,0);
                const setScale = new THREE.Vector3 (1,1,1);
                let teaPotObjw  = new objectSpwn (gltf, setPosition, setScale);
            })
        }
            class Cube {
                constructor(x, y, z, color, rotationSpeed) {
                    this.geometry = new THREE.BoxGeometry(1, 1, 1);
                    this.textureLoader = new THREE.TextureLoader();
                    this.texture = this.textureLoader.load('../assets/bilder/image1'); 
                    this.material = new THREE.MeshLambertMaterial();
                    this.cube = new THREE.Mesh(this.geometry, this.material);
                    scene.add(this.cube);
                    // white outliner
                    this.edges = new THREE.EdgesGeometry(this.geometry);
                    this.lines = new THREE.LineSegments(this.edges, new THREE.LineBasicMaterial({ color: 0xffffff, linewidth: 15 }));
                    this.lines.scale.set(1.01, 1.01, 1.01);
                    this.cube.add(this.lines);
                    // position 
                    this.cube.position.set(x, y, z);
                    // rotation speed
                    this.rotationSpeed = rotationSpeed;
                    this.clock = new THREE.Clock();
                }
                    setColor(color){
                        this.material.color.set(color);
                    }
                animate() {
                    // Your animation code here
                    let deltaTime = this.clock.getDelta();
                    this.cube.rotation.y += this.rotationSpeed.y * deltaTime;
                    this.cube.rotation.x += this.rotationSpeed.x * deltaTime;
                    this.cube.rotation.z += this.rotationSpeed.z * deltaTime;
                }
            }

            function createCube() {
                let cube1 = new Cube(1, 0, 0, 0xc0c0c0, { x: 0.5, y: 0.2, z: 0.5 });
                cube1.setColor(0xc0c0c0);
                cubes.push(cube1);
                let cube2 = new Cube(1, 1.5, 0, 0x3498db, { x: 0.01, y: 0.05, z: 0.01 });
                cube2.setColor(0x0000ff);
                cubes.push(cube2);
                let cube3 = new Cube(1, -1.5, 0, 0x3498db, { x: 0.01, y: 0.05, z: 0.4 });
                cube3.setColor(0x800000);
                cubes.push(cube3);
            }
            cubes.forEach((cube, index) => {
                    var folder = gui.addFolder(`Cube ${index + 1}`);
                    folder.add(cube, 'gravity', 0, 10);
                    gravityFolders.push(folder);
                });


            function init() {
                scene = new THREE.Scene();
                camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
                camera.position.z = 10;
                renderer = new THREE.WebGLRenderer();
                renderer.setSize(window.innerWidth, window.innerHeight);
                document.body.appendChild(renderer.domElement);
            }

        
            function animateCubes() {
                cubes.forEach(Cube => Cube.animate());
            }

            function animate() {
                requestAnimationFrame(animate);
                animateCubes();
                renderer.render(scene, camera);
            }

            function light() {
                var ambientLight = new THREE.AmbientLight(0x404040);
                scene.add(ambientLight);
                var directionalLight = new THREE.DirectionalLight(0xffffff);
                directionalLight.position.set(1, 1, 1).normalize();
                scene.add(directionalLight);
                renderer.render(scene, camera);
            }
            init();
            createCube();
            light();
            animate();
            loadSuzann();
            loadTeapot();
           
            Objinit();




            
        </script>


</html>
